<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>üíç Proposal Universe</title>
<style>
  :root{
    --bg1:#050014;
    --bg2:#180024;
    --pink:#ff4da6;
    --pink2:#ff86c8;
    --gold:#ffd27a;
    --cyan:#67f3ff;
    --card: rgba(255,255,255,.08);
    --cardBorder: rgba(255,255,255,.14);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    overflow:hidden;
    font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Arial;
    background: radial-gradient(1200px 800px at 20% 15%, rgba(255,77,166,.16), transparent 55%),
                radial-gradient(900px 700px at 80% 25%, rgba(255,210,122,.10), transparent 55%),
                linear-gradient(160deg, var(--bg1), var(--bg2));
    color:#fff;
  }

  /* Canvas layers */
  canvas{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    pointer-events:none;
  }
  #stars{filter: blur(.2px);}
  #fx{mix-blend-mode: screen;}

  /* Aurora layer */
  .aurora{
    position:absolute; inset:-25%;
    background:
      radial-gradient(closest-side at 25% 35%, rgba(255,77,166,.18), transparent 60%),
      radial-gradient(closest-side at 70% 30%, rgba(103,243,255,.14), transparent 60%),
      radial-gradient(closest-side at 55% 80%, rgba(255,210,122,.12), transparent 60%);
    filter: blur(26px) saturate(130%);
    opacity:.9;
    mix-blend-mode: screen;
    animation: drift 10s ease-in-out infinite alternate;
    pointer-events:none;
  }
  @keyframes drift{
    0%{transform: translate(-2%, -2%) rotate(-2deg) scale(1.02)}
    100%{transform: translate(2%, 3%) rotate(2deg) scale(1.06)}
  }

  /* Scanner Overlay (camera sparkle reveal) */
  .scanner{
    position:absolute; inset:0;
    display:grid;
    place-items:center;
    background: radial-gradient(900px 700px at 50% 40%, rgba(255,255,255,.05), rgba(0,0,0,.65));
    backdrop-filter: blur(6px);
    z-index: 50;
    transition: opacity .8s ease, transform .8s ease;
  }
  .scanner.hidden{
    opacity:0;
    transform: scale(1.02);
    pointer-events:none;
  }
  .scanBox{
    width:min(420px, 86vw);
    border-radius: 22px;
    border:1px solid rgba(255,255,255,.15);
    background: rgba(0,0,0,.22);
    padding: 18px 16px 16px;
    box-shadow: 0 25px 80px rgba(0,0,0,.45);
    position:relative;
    overflow:hidden;
  }
  .scanTitle{
    display:flex; align-items:center; justify-content:space-between;
    font-weight:900; letter-spacing:.4px;
  }
  .pill{
    font-size:12px;
    padding:6px 10px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.18);
    background: rgba(255,255,255,.08);
    color: rgba(255,255,255,.85);
  }
  .scanArea{
    margin-top:12px;
    height: 220px;
    border-radius: 18px;
    border:1px dashed rgba(255,255,255,.22);
    background: radial-gradient(circle at 30% 30%, rgba(255,77,166,.10), rgba(0,0,0,.18));
    position:relative;
    overflow:hidden;
  }
  .scanLine{
    position:absolute;
    left:-10%;
    width:120%;
    height: 90px;
    top:-30%;
    background: linear-gradient(90deg, transparent, rgba(103,243,255,.18), rgba(255,77,166,.22), transparent);
    filter: blur(4px);
    transform: rotate(8deg);
    animation: sweep 1.3s ease-in-out infinite;
  }
  @keyframes sweep{
    0%{transform: translateY(-120%) rotate(8deg); opacity:.2}
    50%{opacity:1}
    100%{transform: translateY(250%) rotate(8deg); opacity:.2}
  }
  .scanHint{
    margin-top:10px;
    font-size:13px;
    color: rgba(255,255,255,.78);
    line-height:1.35;
  }

  /* Main content */
  .wrap{
    position:relative;
    height:100%;
    display:grid;
    place-items:center;
    padding: 26px;
  }

  .card{
    width:min(720px, 92vw);
    border-radius: 26px;
    background: var(--card);
    border: 1px solid var(--cardBorder);
    backdrop-filter: blur(12px);
    box-shadow: 0 30px 100px rgba(0,0,0,.40);
    overflow:hidden;
    position:relative;
  }

  .topGlow{
    position:absolute; inset:-40%;
    background:
      radial-gradient(circle at 30% 30%, rgba(255,77,166,.24), transparent 55%),
      radial-gradient(circle at 75% 25%, rgba(103,243,255,.14), transparent 60%),
      radial-gradient(circle at 60% 85%, rgba(255,210,122,.14), transparent 60%);
    filter: blur(20px);
    mix-blend-mode: screen;
    opacity:.9;
    pointer-events:none;
  }

  .content{
    padding: 30px 26px 24px;
    display:grid;
    gap: 16px;
    text-align:center;
  }

  .headline{
    font-size: clamp(26px, 5vw, 54px);
    font-weight: 950;
    letter-spacing: -0.6px;
    margin-top: 6px;
  }
  .gradientText{
    background: linear-gradient(90deg, var(--pink), var(--gold), var(--cyan));
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
  }

  .msg{
    font-size: clamp(14.5px, 2.2vw, 19px);
    line-height:1.55;
    color: rgba(255,255,255,.86);
    margin: 0 auto;
    max-width: 58ch;
  }

  /* Heartbeat core */
  .beatZone{
    display:grid;
    place-items:center;
    margin-top: 4px;
  }
  .core{
    width: 110px;
    height: 110px;
    position:relative;
    transform: translateZ(0);
    filter: drop-shadow(0 20px 40px rgba(255,77,166,.25));
  }
  .core .heart{
    position:absolute;
    left:50%; top:50%;
    width: 42px; height: 42px;
    transform: translate(-50%,-50%) rotate(45deg);
    background: var(--pink);
    border-radius: 6px;
    animation: heartbeat 1.05s ease-in-out infinite;
    box-shadow: 0 0 30px rgba(255,77,166,.25);
  }
  .core .heart:before,
  .core .heart:after{
    content:"";
    position:absolute;
    width: 42px; height: 42px;
    background: inherit;
    border-radius: 999px;
  }
  .core .heart:before{left:-21px}
  .core .heart:after{top:-21px}

  .ring{
    position:absolute;
    inset: 8px;
    border-radius: 999px;
    border: 2px solid rgba(255,255,255,.14);
    box-shadow: inset 0 0 24px rgba(103,243,255,.12);
    animation: ringPulse 1.05s ease-in-out infinite;
  }
  .ring2{
    position:absolute;
    inset: -6px;
    border-radius: 999px;
    border: 2px solid rgba(255,77,166,.18);
    animation: ringPulse2 1.05s ease-in-out infinite;
  }
  @keyframes heartbeat{
    0%,100%{transform: translate(-50%,-50%) rotate(45deg) scale(1)}
    20%{transform: translate(-50%,-50%) rotate(45deg) scale(1.16)}
    40%{transform: translate(-50%,-50%) rotate(45deg) scale(1.02)}
    60%{transform: translate(-50%,-50%) rotate(45deg) scale(1.22)}
    80%{transform: translate(-50%,-50%) rotate(45deg) scale(1.04)}
  }
  @keyframes ringPulse{
    0%,100%{transform: scale(1); opacity:.55}
    40%{transform: scale(1.05); opacity:.8}
    70%{transform: scale(1.10); opacity:.35}
  }
  @keyframes ringPulse2{
    0%,100%{transform: scale(1); opacity:.35}
    55%{transform: scale(1.18); opacity:.15}
  }

  /* Proposal buttons */
  .btnRow{
    display:flex;
    gap: 12px;
    justify-content:center;
    flex-wrap:wrap;
    margin-top: 6px;
  }
  .btn{
    border:0;
    cursor:pointer;
    padding: 12px 16px;
    border-radius: 14px;
    font-weight: 900;
    letter-spacing:.2px;
    background: linear-gradient(135deg, var(--pink), var(--gold));
    color:#1b0025;
    min-width: 150px;
    box-shadow: 0 18px 50px rgba(255,77,166,.18);
    transition: transform .15s ease, filter .2s ease;
  }
  .btn:hover{transform: translateY(-1px) scale(1.02); filter:saturate(1.05)}
  .btn:active{transform: scale(.99)}
  .btnNo{
    background: rgba(255,255,255,.08);
    color: rgba(255,255,255,.92);
    border:1px solid rgba(255,255,255,.18);
    box-shadow:none;
  }

  .footerHint{
    font-size:12px;
    color: rgba(255,255,255,.65);
    padding: 0 26px 22px;
    text-align:center;
  }

  /* Tiny floating hearts (DOM) */
  .miniHeart{
    position:absolute;
    width: 14px;
    height: 14px;
    transform: rotate(45deg);
    border-radius: 4px;
    pointer-events:none;
    opacity:.95;
    filter: drop-shadow(0 10px 16px rgba(255,77,166,.18));
    animation: rise var(--dur, 2.4s) ease-out forwards;
  }
  .miniHeart:before,.miniHeart:after{
    content:"";
    position:absolute;
    width: 14px; height: 14px;
    background: inherit;
    border-radius: 999px;
  }
  .miniHeart:before{left:-7px}
  .miniHeart:after{top:-7px}

  @keyframes rise{
    0%{transform: translate(var(--x0), var(--y0)) rotate(45deg) scale(var(--s)); opacity:0}
    15%{opacity:.95}
    100%{transform: translate(var(--x1), var(--y1)) rotate(45deg) scale(calc(var(--s) * 1.18)); opacity:0}
  }

  /* Modal (YES celebration text) */
  .modal{
    position:absolute; inset:0;
    display:grid;
    place-items:center;
    background: rgba(0,0,0,.45);
    backdrop-filter: blur(6px);
    z-index: 30;
    opacity:0;
    pointer-events:none;
    transition: opacity .25s ease;
  }
  .modal.show{
    opacity:1;
    pointer-events:auto;
  }
  .modalBox{
    width:min(520px, 90vw);
    border-radius: 22px;
    border:1px solid rgba(255,255,255,.16);
    background: rgba(255,255,255,.10);
    box-shadow: 0 30px 120px rgba(0,0,0,.55);
    padding: 22px 18px;
    text-align:center;
    position:relative;
    overflow:hidden;
  }
  .modalBox h3{
    margin: 6px 0 8px;
    font-size: 26px;
    font-weight: 950;
  }
  .modalBox p{
    margin:0 0 14px;
    color: rgba(255,255,255,.82);
    line-height:1.5;
  }
  .close{
    position:absolute; right:12px; top:10px;
    cursor:pointer;
    width: 34px; height:34px;
    display:grid; place-items:center;
    border-radius: 12px;
    border:1px solid rgba(255,255,255,.18);
    background: rgba(0,0,0,.18);
    color:#fff;
    font-weight:900;
  }
</style>
</head>
<body>

<div class="aurora"></div>

<canvas id="stars"></canvas>
<canvas id="fx"></canvas>
<canvas id="fire"></canvas>

<!-- Scanner overlay -->
<div class="scanner" id="scanner">
  <div class="scanBox">
    <div class="scanTitle">
      <span>Camera Scan ‚ú®</span>
      <span class="pill">Decrypting Love‚Ä¶</span>
    </div>
    <div class="scanArea">
      <div class="scanLine"></div>
    </div>
    <div class="scanHint">
      Secret message found‚Ä¶ opening your universe üíñ
    </div>
  </div>
</div>

<div class="wrap">
  <div class="card" id="card">
    <div class="topGlow"></div>
    <div class="content">
      <div class="headline">
        <span id="who" class="gradientText">My Love</span> ‚ú®
      </div>

      <div class="msg" id="message">
        You are my universe.
      </div>

      <div class="beatZone">
        <div class="core" id="core">
          <div class="ring"></div>
          <div class="ring2"></div>
          <div class="heart"></div>
        </div>
      </div>

      <div class="headline" style="font-size:clamp(18px,3.2vw,30px); margin-top:2px;">
        Will you marry me? üíç
      </div>

      <div class="btnRow">
        <button class="btn" id="yesBtn">YES ‚ù§Ô∏è</button>
        <button class="btn btnNo" id="noBtn">NO üò∂</button>
      </div>
    </div>

    <div class="footerHint">
      Tap anywhere for sparkles ‚Ä¢ Heartbeat synced magic üíì
    </div>
  </div>
</div>

<!-- Modal for YES -->
<div class="modal" id="modal">
  <div class="modalBox">
    <div class="close" id="close">‚úï</div>
    <h3>YAAAY! üíñüíç</h3>
    <p>
      This moment is yours ‚Äî fireworks for the two of you ‚ú®<br/>
      (Tap around to throw more sparkles!)
    </p>
  </div>
</div>

<script>
/* =========================
   URL PARAMS (name + msg)
========================= */
const params = new URLSearchParams(location.search);
const name = (params.get("name") || "My Love ‚ù§Ô∏è").toString();
const msg  = (params.get("msg")  || "You are my universe ‚ú®").toString();

document.getElementById("who").textContent = name;
document.getElementById("message").textContent = msg;

/* =========================
   Scanner (camera sparkle reveal)
========================= */
const scanner = document.getElementById("scanner");
setTimeout(() => scanner.classList.add("hidden"), 1600);

/* =========================
   Canvas setup helpers
========================= */
function setupCanvas(c){
  const ctx = c.getContext("2d");
  function resize(){
    const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
    c.width  = Math.floor(innerWidth * dpr);
    c.height = Math.floor(innerHeight * dpr);
    c.style.width = innerWidth + "px";
    c.style.height = innerHeight + "px";
    ctx.setTransform(dpr,0,0,dpr,0,0);
  }
  window.addEventListener("resize", resize);
  resize();
  return ctx;
}

const cStars = document.getElementById("stars");
const cFx    = document.getElementById("fx");
const cFire  = document.getElementById("fire");

const sctx = setupCanvas(cStars);
const fctx = setupCanvas(cFx);
const xctx = setupCanvas(cFire);

/* =========================
   STARFIELD (Galaxy)
========================= */
const stars = Array.from({length: 220}, () => ({
  x: Math.random()*innerWidth,
  y: Math.random()*innerHeight,
  r: Math.random()*1.6 + 0.2,
  v: Math.random()*0.45 + 0.15,
  a: Math.random()*0.6 + 0.15
}));

function drawStars(t){
  sctx.clearRect(0,0,innerWidth,innerHeight);

  // subtle nebula glow
  const g = sctx.createRadialGradient(innerWidth*0.35, innerHeight*0.35, 20, innerWidth*0.35, innerHeight*0.35, innerWidth*0.7);
  g.addColorStop(0, "rgba(255,77,166,.08)");
  g.addColorStop(0.5, "rgba(103,243,255,.04)");
  g.addColorStop(1, "rgba(0,0,0,0)");
  sctx.fillStyle = g;
  sctx.fillRect(0,0,innerWidth,innerHeight);

  for(const st of stars){
    st.y += st.v;
    if(st.y > innerHeight + 10) st.y = -10;

    const tw = 0.5 + Math.sin((t*0.001) + st.x*0.01) * 0.25;
    const alpha = Math.max(0.06, Math.min(0.95, st.a * tw));

    sctx.beginPath();
    sctx.fillStyle = `rgba(255,255,255,${alpha})`;
    sctx.arc(st.x, st.y, st.r, 0, Math.PI*2);
    sctx.fill();
  }
}

/* =========================
   Sparkles particles (tap + heartbeat)
========================= */
const spark = [];
function addSparkles(x,y, n=10, power=1){
  for(let i=0;i<n;i++){
    spark.push({
      x,y,
      vx:(Math.random()*2-1)*2.2*power,
      vy:(Math.random()*2-1)*2.2*power - 1.2*power,
      life: Math.random()*40 + 35,
      size: Math.random()*2.2 + 1,
      hue: (Math.random()*80 + 300) % 360
    });
  }
}

function drawSparkles(){
  fctx.clearRect(0,0,innerWidth,innerHeight);
  for(let i=spark.length-1;i>=0;i--){
    const p = spark[i];
    p.x += p.vx;
    p.y += p.vy;
    p.vy += 0.03;
    p.life -= 1;

    const a = Math.max(0, Math.min(1, p.life/70));
    fctx.save();
    fctx.translate(p.x, p.y);
    fctx.rotate((70 - p.life) * 0.12);
    fctx.strokeStyle = `hsla(${p.hue}, 95%, 70%, ${a})`;
    fctx.lineWidth = 1.3;
    fctx.beginPath();
    fctx.moveTo(-p.size, 0); fctx.lineTo(p.size, 0);
    fctx.moveTo(0, -p.size); fctx.lineTo(0, p.size);
    fctx.stroke();
    fctx.restore();

    if(p.life <= 0) spark.splice(i,1);
  }
}

/* click/tap sparkles */
addEventListener("pointerdown", (e)=>{
  addSparkles(e.clientX, e.clientY, 14, 1.1);
  miniHearts(e.clientX, e.clientY, 6);
});

/* =========================
   Heartbeat synced effect
========================= */
const core = document.getElementById("core");
let beat = 0;
function heartbeatTick(){
  // approx match CSS 1.05s cycle -> do a "double beat"
  const rect = core.getBoundingClientRect();
  const cx = rect.left + rect.width/2;
  const cy = rect.top + rect.height/2;

  // 2 hits per cycle: lub-dub vibe
  if(beat % 2 === 0){
    addSparkles(cx, cy, 10, 0.9);
    miniHearts(cx, cy, 3);
  } else {
    addSparkles(cx, cy, 7, 0.75);
  }
  beat++;
}
setInterval(heartbeatTick, 525); // half of 1.05s

/* =========================
   Mini floating hearts (DOM)
========================= */
function miniHearts(x,y,n=6){
  const colors = ["#ff4da6","#ff86c8","#ffd27a","#67f3ff"];
  for(let i=0;i<n;i++){
    const h = document.createElement("div");
    h.className = "miniHeart";
    const s = (Math.random()*0.7 + 0.7).toFixed(2);
    const dx0 = (Math.random()*22 - 11).toFixed(0);
    const dy0 = (Math.random()*18 - 9).toFixed(0);
    const dx1 = (Math.random()*160 - 80).toFixed(0);
    const dy1 = (Math.random()*-260 - 120).toFixed(0);
    h.style.setProperty("--s", s);
    h.style.setProperty("--x0", dx0+"px");
    h.style.setProperty("--y0", dy0+"px");
    h.style.setProperty("--x1", dx1+"px");
    h.style.setProperty("--y1", dy1+"px");
    h.style.setProperty("--dur", (Math.random()*0.9 + 2.0).toFixed(2)+"s");
    h.style.left = x+"px";
    h.style.top  = y+"px";
    h.style.background = colors[(Math.random()*colors.length)|0];
    document.body.appendChild(h);
    h.addEventListener("animationend", ()=>h.remove());
  }
}

/* =========================
   Fireworks (YES)
========================= */
let fireworksOn = false;
const fireworks = [];

function launchFirework(){
  const x = Math.random()*innerWidth*0.8 + innerWidth*0.1;
  const y = innerHeight + 10;
  const tx = x;
  const ty = Math.random()*innerHeight*0.35 + innerHeight*0.12;
  fireworks.push({
    phase:"rise",
    x,y,
    vx:(Math.random()*0.6 - 0.3),
    vy:-(Math.random()*5 + 7),
    tx,ty,
    hue: Math.random()*360
  });
}

function explode(x,y,hue){
  const count = 70;
  for(let i=0;i<count;i++){
    const a = (i/count) * Math.PI*2;
    const sp = Math.random()*4.2 + 1.8;
    fireworks.push({
      phase:"spark",
      x,y,
      vx: Math.cos(a)*sp*(Math.random()*0.8+0.6),
      vy: Math.sin(a)*sp*(Math.random()*0.8+0.6),
      life: Math.random()*55 + 45,
      hue: hue + (Math.random()*40 - 20),
      size: Math.random()*2.2 + 1
    });
  }
  // extra hearts blast
  miniHearts(x,y,10);
  addSparkles(x,y,18,1.35);
}

function drawFireworks(){
  xctx.clearRect(0,0,innerWidth,innerHeight);

  for(let i=fireworks.length-1;i>=0;i--){
    const p = fireworks[i];

    if(p.phase==="rise"){
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.08; // gravity
      xctx.beginPath();
      xctx.fillStyle = `hsla(${p.hue}, 100%, 70%, .9)`;
      xctx.arc(p.x,p.y,2.2,0,Math.PI*2);
      xctx.fill();

      if(p.y <= p.ty || p.vy > -1){
        explode(p.x,p.y,p.hue);
        fireworks.splice(i,1);
      }
    } else {
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.03;
      p.life -= 1;

      const a = Math.max(0, Math.min(1, p.life/90));
      xctx.beginPath();
      xctx.fillStyle = `hsla(${p.hue}, 100%, 70%, ${a})`;
      xctx.arc(p.x,p.y,p.size,0,Math.PI*2);
      xctx.fill();

      if(p.life<=0) fireworks.splice(i,1);
    }
  }
}

/* =========================
   Proposal buttons
========================= */
const yesBtn = document.getElementById("yesBtn");
const noBtn  = document.getElementById("noBtn");
const modal  = document.getElementById("modal");
const close  = document.getElementById("close");

yesBtn.addEventListener("click", ()=>{
  modal.classList.add("show");
  fireworksOn = true;

  // start a quick show
  for(let i=0;i<3;i++){
    setTimeout(launchFirework, i*220);
  }
});

close.addEventListener("click", ()=> modal.classList.remove("show"));

/* NO button runs away üòÑ */
noBtn.addEventListener("mouseenter", fleeNo);
noBtn.addEventListener("click", ()=>{
  addSparkles(innerWidth*0.5, innerHeight*0.5, 26, 1.2);
  fleeNo();
});
function fleeNo(){
  const pad = 18;
  const bx = Math.random()*(innerWidth - noBtn.offsetWidth - pad*2) + pad;
  const by = Math.random()*(innerHeight - noBtn.offsetHeight - pad*2) + pad;

  noBtn.style.position = "fixed";
  noBtn.style.left = bx + "px";
  noBtn.style.top  = by + "px";
}

/* =========================
   Main animation loop
========================= */
let lastLaunch = 0;
function loop(t){
  drawStars(t);
  drawSparkles();

  if(fireworksOn){
    // launch periodically
    if(t - lastLaunch > 520){
      launchFirework();
      lastLaunch = t;
    }
    drawFireworks();
  }else{
    xctx.clearRect(0,0,innerWidth,innerHeight);
    // keep list tidy
    if(fireworks.length) fireworks.length = 0;
  }

  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* initial sparkle after scan reveal */
setTimeout(()=>{
  addSparkles(innerWidth*0.5, innerHeight*0.42, 22, 1.1);
}, 1750);
</script>
</body>
</html>
